<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ranking UniFECAF</title>
  </head>
  <body>
    <h1>üèÜ TOP 3 INTERNOS</h1>
    <table border="1" id="tabelaInternos">
      <thead>
        <tr>
          <th>Consultor</th>
          <th>Presencial</th>
          <th>EAD</th>
          <th>Semi</th>
          <th>Intelig√™ncia Artificial</th>
          <th>P√≥s-Gradua√ß√£o</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h1>üåé TOP 3 EXTERNOS</h1>
    <table border="1" id="tabelaExternos">
      <thead>
        <tr>
          <th>Consultor</th>
          <th>Presencial</th>
          <th>EAD</th>
          <th>Semi</th>
          <th>Intelig√™ncia Artificial</th>
          <th>P√≥s-Gradua√ß√£o</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h1>üìä RANKING GERAL</h1>
    <table border="1" id="tabelaGeral">
      <thead>
        <tr>
          <th>Consultor</th>
          <th>Presencial</th>
          <th>EAD</th>
          <th>Semi</th>
          <th>Intelig√™ncia Artificial</th>
          <th>P√≥s-Gradua√ß√£o</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      const url =
        "https://opensheet.elk.sh/12fP3mNTB1WwRE4Y41Xjpx9TzdfhXaVrZ5B-XsO9jgEc/base";

      fetch(url)
        .then((res) => res.json())
        .then((dados) => {
          const internos = dados.filter((d) => d["Tipo"] === "Interno");
          const externos = dados.filter((d) => d["Tipo"] === "Externo");

          const topInternos = internos
            .sort((a, b) => b["TOTAL GERAL"] - a["TOTAL GERAL"])
            .slice(0, 3);
          const topExternos = externos
            .sort((a, b) => b["TOTAL GERAL"] - a["TOTAL GERAL"])
            .slice(0, 3);

          preencherTabela("tabelaInternos", topInternos);
          preencherTabela("tabelaExternos", topExternos);
          preencherTabela(
            "tabelaGeral",
            dados.sort((a, b) => b["TOTAL GERAL"] - a["TOTAL GERAL"])
          );
        });

      function criarLinha(d) {
        return `
          <tr>
            <td>${d["Consultores"]}</td>
            <td>${d["Matriculas Presencial"]}</td>
            <td>${d["Matriculas Ead"]}</td>
            <td>${d["Matriculas Semi-Presencial"]}</td>
            <td>${d["Intelig√™ncia Artificial"] || 0}</td>
            <td>${d["P√≥s-Gradua√ß√£o"] || 0}</td>
            <td>${d["TOTAL GERAL"]}</td>
          </tr>
        `;
      }

      function preencherTabela(id, dados) {
        document.querySelector(`#${id} tbody`).innerHTML = dados
          .map(criarLinha)
          .join("");
      }
    </script>
  </body>
</html>
